## Intro

As you know, Splunk supports Apps and Add-ons. It even has its own [market](https://splunkbase.splunk.com/).
Unfortunately, not all third-party apps have a sufficient level of security. Below is the POC for RCE and Stored XSS in [Tour Creation App for Splunk](https://splunkbase.splunk.com/app/2899/) <= 3.0.0.

## Description

The app allows you to create online tours for "helping users onboard easier". Tours can be accompanied by images and the imagese upload feature check almost nothing. So, you can upload an arbitrary file to any folder inside `$SPLUNK_HOME`.

## Steps to reproduce 

1. Open the App main page.
2. Create a new image tour.
3. Click *Add Slide* and upload your image. File will be uploaded to the static folder of the App.

You can change the content of the file to an XSS payload and get stored XSS.

To get RCE you should be able to write not only to the static dir. The parameter `tourName` in upload request is vulnerable to path traversal. This fact opens all doors for you. `README.md` conatins info about ways to rce.
