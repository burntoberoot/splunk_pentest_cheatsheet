# Splunk pentest cheatsheet

## SPL

### Usefull SPL requests

- `| metasearch index=* | chart count over source by index` - get all indexes
- `| chart count by source | sort count desc` - get indexes and sources
- `| search index=<index name>` - get content of an index
- `| inputcsv 123.csv` - get the value of $SPLUNK_HOME

## Ways to enumerate users

### Authenticated

- `https://<host>/en-US/splunkd/__raw/servicesNS/<username>/user-prefs/data/user-prefs/general`

## Misc

### Check your capabilities and other info

- `https://<host>/en-US/splunkd/__raw/services/authentication/users/<yourusername>`

### Usefull Links

- https://threat.tevora.com/penetration-testing-with-splunk-leveraging-splunk-admin-credentials-to-own-the-enterprise/
- https://docs.splunk.com/Documentation/Splunk/latest/Security/WhatyoucansecurewithSplunk
